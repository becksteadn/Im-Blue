---
- name: Add a new linux user
  hosts: linux
  vars_prompt:
    - name: username
      prompt: "Username"
      confirm: yes
  tasks:
    - name: Add user
      user:
        name: '{{ username }}'
        shell: /bin/bash
        groups: sudo
      notify: Add key

  handlers:
    - name: Add key
      authorized_key:
        user: '{{ username }}'
        key: "{{ lookup('file', 'keys/id_rsa.pub') }}"
        state: present
